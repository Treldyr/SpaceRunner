<!DOCTYPE html>
<html>
<head>
	<title>Space Runner</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Lien vers Bootstrap CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<!-- Lien vers jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- Lien vers Bootstrap JS -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../../css/style_select.css">
    <link rel="stylesheet" href="../../css/default.css">
	<link rel="icon" href="../../images/p1down.png">
</head>
<body>
    <div class="background-image"></div>
    <div class="content">
        <h1 class="custom-title">Space Runner</h1>
        <h1 >Choisissez le joueur 2</h1>
        <div class="container">
            <div class="row" id="listChar1">
                <div class="col-md-3">
                    <img src="../../images/fantomp0.png" class="img-thumbnail selected" id='p0' onclick="selectImage('p0')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp1.png" class="img-thumbnail" id='p1' onclick="selectImage('p1')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp2.png" class="img-thumbnail" id='p2' onclick="selectImage('p2')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp3.png" class="img-thumbnail" id='p3' onclick="selectImage('p3')">
                </div>
            </div>

            <div class="row" id="listChar2">
                <div class="col-md-3">
                    <img src="../../images/fantomp4.png" class="img-thumbnail" id='p4' onclick="selectImage('p4')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp5.png" class="img-thumbnail" id='p5' onclick="selectImage('p5')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp6.png" class="img-thumbnail" id='p6' onclick="selectImage('p6')">
                </div>
                <div class="col-md-3">
                    <img src="../../images/fantomp7.png" class="img-thumbnail" id='p7' onclick="selectImage('p7')">
                </div>
            </div>

            <!-- Champ caché pour stocker l'image sélectionnée -->
            <input type="hidden" id="selected-image" name="selected-image">
        </div>
        <button class="btn-start" onclick="acceptPlayer()">Commencer</button>
    </div>
    <script src="../../common_functions/sounds.js"></script>
    <script src="../../common_functions/unlocks.js"></script>
	<script>
        var char = "p0"
        var lvlGhost = 1;
        retrieveAchievements();
        lockUnusableGhosts();

		// Fonction pour sélectionner une image
		function selectImage(imageId) {
            playSoundButton()
			// Désélectionne toutes les images
			$('.img-thumbnail').removeClass('selected');
			// Sélectionne l'image cliquée
			$('#' + imageId).addClass('selected');
			// Stocke l'ID
            $('#selected-image').val(imageId);
            // stocke dans la balise p l'image
            char = imageId
		}

        function playSoundButton() {
            var audio = new Audio('../../sons/bright.wav');
            audio.play();
        }

        function acceptPlayer() {
            var charChosen = {
                ghost : char
            };
            var dataString = JSON.stringify(charChosen);
            localStorage.setItem('ghostChosen', dataString);
            window.location.href = 'carte.html'
        }

        function retrieveAchievements() {
            var storedData = localStorage.getItem('ghostData');
            if (storedData !== null) {
                var ghostData = JSON.parse(storedData);
                lvlGhost = ghostData.ghostUnlock;
            }
        }

        function lockUnusableGhosts(){
            if(lvlGhost<2){
                lockImage("p2")
                lockImage("p3")
            }
            if(lvlGhost<3){
                lockImage("p4")
                lockImage("p5")
            }
            if(lvlGhost<4){
                lockImage("p6")
                lockImage("p7")
            }
        }

        function lockImage(imageId) {
            var image = document.getElementById(imageId);
            image.classList.add('locked');               // Ajoute la classe de verrouillage
            image.onclick = null;                        // Désactive le clic
            image.src = "../../images/locked.png";          // Ajoute l'image de cadenas
        }

	</script>
</body>
</html>
